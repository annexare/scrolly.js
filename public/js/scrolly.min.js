/*  scrolly v0.4.0, 2014.12.29  */
var dataSet=function(){return document.documentElement.dataset?function(e,t,n){return"undefined"!=typeof n?e.dataset[t]=n:e.dataset[t]}:function(e,t,n){return"undefined"!=typeof n?e.setAttribute("data-"+t,n):e.getAttribute("data-"+t)}}();(function(){"use strict";var e="Scrolly",t=function(e){return"scrolly"+e},n=function(t){return e+": "+t},i=function(e,t){var n=(t.className||"").split(/\s+/);return-1===n.indexOf(e)&&n.push.apply(n,[e]),t.className=n.join(" ")},a=function(e,t){var n=(t.className||"").split(/\s+/);return-1!==n.indexOf(e)},r=function(e,t){var n=(t.className||"").split(/\s+/),i=n.indexOf(e);return-1!==i&&n.splice(i,1),t.className=n.join(" ")},o=function(e){var t=document.createElement("div");return t.className=e||"",t},s=function(e,t){var n=e.parentNode;if(a(t,n))return n;var i=o(t);return n.insertBefore(i,e),i.appendChild(e),i},u={X:"Width",Y:"Height"},l={X:"Left",Y:"Top"},d=function(e,t){return t["page"+e]||t["client"+e]},c=function(e,t,n){return e[(n||"scroll")+l[t]]},f=function(e,t,n){return e[(n||"scroll")+u[t]]},h=function(e){var t=c(e.wrap,e.axis)||0;return Math.floor((t+e.wrapSize/2)*e.wrapRatio)},p=function(e){return e+"px"},m="ontouchstart"in document.documentElement,b="onwheel"in document||document.documentMode>=9?"wheel":"undefined"==typeof document.onmousewheel?"DOMMouseScroll":"mousewheel",v=function(e){document.body.onmousemove=document.body.onmouseup=null,document.ontouchmove=document.ontouchend=null,r(this.noUserSelectClass,document.body),r(this.onDragClass,e.bar)},y=function(e,t){var n=this,a=d(e.axis,t),r=0,o=1*e.thumb.style.top.replace("px",""),s=function(t){r=d(e.axis,t)-a+e.thumbSize/2,m&&(r*=-.5),n.setThumbPos.call(n,e,o+r,!0)},u=function(){v.call(n,e)};i(this.noUserSelectClass,document.body),i(this.onDragClass,e.bar),m?(document.ontouchmove=function(e){e.preventDefault(),s(e.touches[0])},document.ontouchend=u):(document.body.onmousemove=s,document.body.onmouseup=u)},w=function(e,t){if(1!==e.wrapRatio){var n=c(e.wrap,e.axis)+t["delta"+e.axis];e.wrapRatio=e.wrapSize/f(e.area,e.axis),n>0&&n+e.wrapSize<f(e.area,e.axis)&&(t.preventDefault(),t.stopPropagation()),e.wrap["scroll"+l[e.axis]]+=t["delta"+e.axis],this.setThumbPos(e)}},S=[],x={axis:"Y",onDragClass:"on-drag",onResize:!1,noUserSelectClass:"no-user-select",thumbMinSize:24,bar:function(e,t){if(!e)return console.log(n("No Query specified.")),!1;var i="string"==typeof e?document.querySelectorAll(e):e;if(!i.length)return i instanceof HTMLElement?[this.barNode(i,t)]:(console.log(n("Couldn't query:"),typeof e,e,t),!1);for(var a=[],r=0;r<i.length;r++)a.push(this.barNode(i[r],t));return a},barNode:function(e,n){"undefined"!=typeof dataSet(e,t("id"))&&this.dispose(dataSet(e,t("id"))),this.onResize||window.addEventListener("resize",this.updateAll.bind(this),!0);var a=n||{},r={params:a,scrolled:0,visible:!1};r.axis=a.axis||this.axis,r.thumbMinSize=a.thumbMinSize||this.thumbMinSize,i("area",e),r.wrap=s(e,"scrolly"),r.area=e;var u=o("bar");r.thumb=u.appendChild(o("thumb")),r.bar=r.wrap.parentNode.insertBefore(u,r.wrap.nextSibling);var l=dataSet(e,t("id"),S.push(r)-1);return this.update(l,!0),l},dispose:function(e){var n=e?parseInt(e):!1;if("number"!=typeof n)return!1;var i=S[n];return i&&"undefined"!=typeof i?(i.observer.disconnect(),r("area",i.area),i.area.removeAttribute("data-"+t("id")),i.wrap.parentNode.insertBefore(i.area,i.wrap),i.wrap.parentNode.removeChild(i.wrap),i.bar.parentNode.removeChild(i.bar),S[n]=!1,!0):!0},disposeAll:function(){for(var e=0;e<S.length;e++)this.dispose(e)},getID:function(e){return dataSet(e.area,t("id"))},update:function(e,t){var n=S[e];n&&(this.setSize(n),t&&this.setEvents(n))},updateAll:function(){for(var e=0;e<S.length;e++)this.update(e)},setEvents:function(e){var t=this;e.observer=new MutationObserver(function(){t.update(t.getID(e))}),e.observer.observe(e.area,{attributes:!0,childList:!0});var n=function(n){y.call(t,e,n)};m?e.wrap.ontouchstart=function(e){1===e.touches.length&&(e.preventDefault(),e.stopPropagation(),n(e.touches[0]))}:(e.wrap.addEventListener(b,function(n){w.call(t,e,n)}),e.bar.addEventListener("mousedown",n)),e.thumb.addEventListener("click",function(e){e&&(e.preventDefault(),e.stopPropagation())}),e.bar.addEventListener("click",function(n){var i=n["layer"+e.axis];t.setThumbPos.call(t,e,i,!0)})},setSize:function(e){var t=e.wrapSize=f(e.wrap,e.axis,"offset"),n=f(e.area,e.axis);if(e.visible=n>t,!e.visible)return void(e.bar.style.visibility="hidden");var i=e.wrapRatio=t/n,a=e.thumbSize=Math.min(t,Math.max(e.thumbMinSize,t*i));e.thumb.style.height=p(a),e.thumbSize=f(e.thumb,e.axis,"offset"),this.setThumbPos(e),e.bar.style.height=p(t),e.bar.style.visibility="visible"},setThumbPos:function(e,t,n){var i="number"==typeof t?t:h(e),a=e.thumbSize/2,r=e.wrapSize-e.thumbSize,o=a>i?0:i-a;o=o>r?r:o,e.thumb.style[l[e.axis].toLowerCase()]=p(o),n&&(o=o===r?e.wrapSize:o,e.wrap["scroll"+l[e.axis]]=Math.floor(o/e.wrapSize*f(e.area,e.axis)))}};if("undefined"!=typeof module&&module.exports)module.exports=x;else if("undefined"!=typeof define&&define.amd)define([],function(){return x});else{this.scrolly=x,this.scrollyst=S;var g=this.$||this.jQuery||this.Zepto||this.jBone;g&&g.fn&&(g.fn.scrolly=function(e){var n=e||{};return n.dispose?this.length&&this.forEach(function(e){x.dispose(dataSet(e,t("id")))}):x.bar(this,n),this})}}).call(this);